"use strict";(self.webpackChunkapi=self.webpackChunkapi||[]).push([[6750],{86726:($,H,t)=>{t.r(H),t.d(H,{default:()=>de});var e=t(67294),a=t(41580),L=t(82777),R=t(77296),Z=t(42761),K=t(38939),C=t(15234),S=t(29728),u=t(5458),F=t(8060),w=t(79031),s=t(37909),n=t(75515),o=t(63237);const m=()=>e.createElement(F.h,null,e.createElement(w.Tr,null,e.createElement(s.Th,null,e.createElement(o.T,null,"INDEX")),e.createElement(s.Th,null,e.createElement(n.Z,{variant:"sigma"},"NAME")),e.createElement(s.Th,null,e.createElement(n.Z,{variant:"sigma"},"IN MEILISEARCH ?")),e.createElement(s.Th,null,e.createElement(n.Z,{variant:"sigma"},"INDEXING ?")),e.createElement(s.Th,null,e.createElement(n.Z,{variant:"sigma"},"INDEX NAME")),e.createElement(s.Th,null,e.createElement(n.Z,{variant:"sigma"},"DOCUMENTS")),e.createElement(s.Th,null,e.createElement(n.Z,{variant:"sigma"},"HOOKS")),e.createElement(s.Th,null,e.createElement(o.T,null,"Actions")))),r=(0,e.memo)(m);var h=t(92155),p=t(11047);const N=({entry:l,deleteCollection:i,addCollection:g,updateCollection:x})=>e.createElement(w.Tr,{key:l.contentType},e.createElement(s.Td,null,e.createElement(h.C,{"aria-label":`Select ${l.collection}`,onValueChange:()=>{l.indexed?i({contentType:l.contentType}):g({contentType:l.contentType})},value:l.indexed})),e.createElement(s.Td,null,e.createElement(n.Z,{textColor:"neutral800"},l.collection)),e.createElement(s.Td,null,e.createElement(n.Z,{textColor:"neutral800"},l.indexed?"Yes":"No")),e.createElement(s.Td,null,e.createElement(n.Z,{textColor:"neutral800"},l.isIndexing?"Yes":"No")),e.createElement(s.Td,null,e.createElement(n.Z,{textColor:"neutral800"},l.indexUid)),e.createElement(s.Td,null,e.createElement(n.Z,{textColor:"neutral800"},l.numberOfDocuments," / ",l.numberOfEntries)),e.createElement(s.Td,null,e.createElement(n.Z,{textColor:"neutral800"},l.reloadNeeded)),e.createElement(s.Td,null,e.createElement(p.k,null,e.createElement(a.x,{paddingLeft:1},e.createElement(S.z,{onClick:()=>x({contentType:l.contentType}),size:"S",variant:"secondary"},"Update"))))),M=(0,e.memo)(N);var W=t(98161),T=t.n(W);function U(){const l=(0,u.lm)();return{handleNotification:({type:g="info",message:x="Something occured in Meilisearch",link:I,blockTransition:y=!0})=>{l({type:g,message:{id:"notification.meilisearch.message",defaultMessage:x},link:I,blockTransition:y,onClose:()=>localStorage.setItem("STRAPI_UPDATE_NOTIF",!0)})}}}const D=U,z=({indexed:l,listened:i})=>{if(l&&!i||!l&&i)return"Reload needed";if(l&&i)return"Hooked";if(!l&&!i)return"/"};function G(){const[l,i]=(0,e.useState)([]),[g,x]=(0,e.useState)(!0),[I,y]=(0,e.useState)(!1),[v,j]=(0,e.useState)(!1),{handleNotification:c}=D(),k=()=>x(E=>!E),P=async()=>{const{data:E,error:d}=await(0,u.WY)(`/${T()}/content-type/`,{method:"GET"});if(d)c({type:"warning",message:d.message,link:d.link});else{const B=E.contentTypes.map(b=>(b.reloadNeeded=z({indexed:b.indexed,listened:b.listened}),b)),ue=B.find(b=>b.reloadNeeded==="Reload needed"),me=B.find(b=>b.isIndexing===!0);j(!!me),y(!!ue),i(B)}},O=async({contentType:E})=>{const{error:d}=await(0,u.WY)(`/${T()}/content-type/${E}`,{method:"DELETE"});d?c({type:"warning",message:d.message,link:d.link}):(k(),c({type:"success",message:"Request to delete content-type is successful",blockTransition:!1}))},f=async({contentType:E})=>{const{error:d}=await(0,u.WY)(`/${T()}/content-type`,{method:"POST",body:{contentType:E}});d?c({type:"warning",message:d.message,link:d.link}):(k(),c({type:"success",message:"Request to add a content-type is successful",blockTransition:!1}))},A=async({contentType:E})=>{const{error:d}=await(0,u.WY)(`/${T()}/content-type`,{method:"PUT",body:{contentType:E}});d?c({type:"warning",message:d.message,link:d.link}):(k(),c({type:"success",message:"Request to update content-type is successful",blockTransition:!1}))};return(0,e.useEffect)(()=>{P()},[g]),(0,e.useEffect)(()=>{let E;return v?E=setInterval(()=>{k()},1e3):clearInterval(E),()=>clearInterval(E)},[v]),{collections:l,deleteCollection:O,addCollection:f,updateCollection:A,reloadNeeded:I,refetchCollection:k,handleNotification:c}}const V=G,X=()=>{const{collections:l,deleteCollection:i,addCollection:g,updateCollection:x,reloadNeeded:I,refetchCollection:y}=V(),{lockAppWithAutoreload:v,unlockAppWithAutoreload:j}=(0,u.Vu)(),[c,k]=(0,e.useState)(!1),P=6,O=10,f=async()=>{try{v(),await(0,u.WY)(`/${T()}/reload`,{method:"GET"},!0),k(!1)}catch(A){console.error(A)}finally{j(),y()}};return(0,e.useEffect)(()=>{c&&f()},[c]),e.createElement(a.x,{background:"neutral100"},e.createElement(K.i,{colCount:O,rowCount:P},e.createElement(r,null),e.createElement(C.p,null,l.map(A=>e.createElement(M,{key:A.collection,entry:A,deleteCollection:i,addCollection:g,updateCollection:x})))),I&&e.createElement(a.x,{padding:5},e.createElement(S.z,{onClick:()=>k(!0)},"Reload server")))},J=(0,e.memo)(X);var Y=t(16364);function Q(){const[l,i]=(0,e.useState)({host:"",apiKey:"",ApiKeyIsFromConfigFile:!0,HostIsFromConfigFile:!0}),[g,x]=(0,e.useState)(!0),[I,y]=(0,e.useState)(""),[v,j]=(0,e.useState)(""),{handleNotification:c}=D(),k=()=>x(f=>!f),P=async()=>{const{error:f}=await(0,u.WY)(`/${T()}/credential`,{method:"POST",body:{apiKey:v,host:I}});f?c({type:"warning",message:f.message,link:f.link}):(k(),c({type:"success",message:"Credentials sucessfully updated!",blockTransition:!1}))},O=async()=>{const{data:f,error:A}=await(0,u.WY)(`/${T()}/credential`,{method:"GET"});A?c({type:"warning",message:A.message,link:A.link}):(i(f),y(f.host),j(f.apiKey))};return(0,e.useEffect)(()=>{O()},[g]),{credentials:l,updateCredentials:P,setHost:y,setApiKey:j,host:I,apiKey:v}}const he=null,q=()=>{const{host:l,apiKey:i,credentials:g,setHost:x,setApiKey:I,updateCredentials:y}=Q();return e.createElement(a.x,null,e.createElement(a.x,{padding:2},e.createElement(Y.o,{placeholder:"Host",label:"Meilisearch Host",name:"host",hint:"The host on which your Meilisearch is running",value:l,onChange:v=>x(v.target.value),disabled:g.HostIsFromConfigFile})),e.createElement(a.x,{padding:2},e.createElement(Y.o,{placeholder:"API key",label:"Meilisearch API Key",name:"apiKey",hint:"A valid API key with enough permission to create indexes (or the master key).",onChange:v=>I(v.target.value),value:i,disabled:g.ApiKeyIsFromConfigFile,"aria-label":"Password",type:"password"})),e.createElement(a.x,{paddingTop:1,paddingLeft:2},e.createElement(n.Z,{variant:"pi",style:{color:"red"}},"Do not use this API key on your front-end as it has too much rights. Instead, use the public key available using"," ",e.createElement("a",{href:"https://docs.meilisearch.com/reference/api/keys.html#get-keys"},"the key route"),".")),e.createElement(a.x,{paddingTop:2,paddingLeft:2,paddingRight:2,paddingBottom:2},e.createElement(S.z,{variant:"secondary",onClick:()=>y(),disabled:g.ApiKeyIsFromConfigFile&&g.HostIsFromConfigFile},"Save")))},_=(0,e.memo)(q),ee=()=>e.createElement(a.x,{padding:5},e.createElement(_,null)),te=(0,e.memo)(ee),ne=()=>e.createElement(a.x,{padding:8,margin:10,background:"neutral"},e.createElement(L.v,{label:"Some stuff for the label",id:"tabs"},e.createElement(R.m,null,e.createElement(R.O,null,"Collections"),e.createElement(R.O,null,"Settings")),e.createElement(Z.n,null,e.createElement(Z.x,null,e.createElement(a.x,{color:"neutral800",padding:4,background:"neutral0"},e.createElement(J,null))),e.createElement(Z.x,null,e.createElement(a.x,{color:"neutral800",padding:4,background:"neutral0"},e.createElement(te,null)))))),le=(0,e.memo)(ne);var ae=t(67109),se=t(23620),oe=t(53979);const re=()=>e.createElement(a.x,{background:"neutral100"},e.createElement(oe.A,{navigationAction:e.createElement(se.r,{startIcon:e.createElement(ae.Z,null),to:"/"},"Go back"),title:"Meilisearch",subtitle:"strapi-plugin-meilisearch",as:"h2"})),ie=(0,e.memo)(re),ce=()=>e.createElement("div",null,e.createElement(ie,null),e.createElement(le,null)),de=(0,e.memo)(ce)},53979:($,H,t)=>{t.d(H,{A:()=>s,T:()=>F});var e=t(85893),a=t(67294),L=t(88972);const R=n=>{const o=(0,a.useRef)(null),[m,r]=(0,a.useState)(!0),h=([p])=>{r(p.isIntersecting)};return(0,a.useEffect)(()=>{const p=o.current,N=new IntersectionObserver(h,n);return p&&N.observe(o.current),()=>{p&&N.disconnect()}},[o,n]),[o,m]};var Z=t(79698);const K=(n,o)=>{const m=(0,Z.W)(o);(0,a.useLayoutEffect)(()=>{const r=new ResizeObserver(m);return Array.isArray(n)?n.forEach(h=>{h.current&&r.observe(h.current)}):n.current&&r.observe(n.current),()=>{r.disconnect()}},[n,m])};var C=t(41580),S=t(11047),u=t(75515);const F=n=>{const o=(0,a.useRef)(null),[m,r]=(0,a.useState)(null),[h,p]=R({root:null,rootMargin:"0px",threshold:0});return K(h,()=>{h.current&&r(h.current.getBoundingClientRect())}),(0,a.useEffect)(()=>{o.current&&r(o.current.getBoundingClientRect())},[o]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{style:{height:m?.height},ref:h,children:p&&(0,e.jsx)(s,{ref:o,...n})}),!p&&(0,e.jsx)(s,{...n,sticky:!0,width:m?.width})]})};F.displayName="HeaderLayout";const w=(0,L.ZP)(C.x)`
  width: ${({width:n})=>n?`${n/16}rem`:void 0};
  z-index: ${({theme:n})=>n.zIndices[1]};
`,s=a.forwardRef(({navigationAction:n,primaryAction:o,secondaryAction:m,subtitle:r,title:h,sticky:p,width:N,...M},W)=>{const T=typeof r=="string";return p?(0,e.jsx)(w,{paddingLeft:6,paddingRight:6,paddingTop:3,paddingBottom:3,position:"fixed",top:0,right:0,background:"neutral0",shadow:"tableShadow",width:N,"data-strapi-header-sticky":!0,children:(0,e.jsxs)(S.k,{justifyContent:"space-between",children:[(0,e.jsxs)(S.k,{children:[n&&(0,e.jsx)(C.x,{paddingRight:3,children:n}),(0,e.jsxs)(C.x,{children:[(0,e.jsx)(u.Z,{variant:"beta",as:"h1",...M,children:h}),T?(0,e.jsx)(u.Z,{variant:"pi",textColor:"neutral600",children:r}):r]}),m?(0,e.jsx)(C.x,{paddingLeft:4,children:m}):null]}),(0,e.jsx)(S.k,{children:o?(0,e.jsx)(C.x,{paddingLeft:2,children:o}):void 0})]})}):(0,e.jsxs)(C.x,{ref:W,paddingLeft:10,paddingRight:10,paddingBottom:8,paddingTop:n?6:8,background:"neutral100","data-strapi-header":!0,children:[n?(0,e.jsx)(C.x,{paddingBottom:2,children:n}):null,(0,e.jsxs)(S.k,{justifyContent:"space-between",children:[(0,e.jsxs)(S.k,{minWidth:0,children:[(0,e.jsx)(u.Z,{as:"h1",variant:"alpha",...M,children:h}),m?(0,e.jsx)(C.x,{paddingLeft:4,children:m}):null]}),o]}),T?(0,e.jsx)(u.Z,{variant:"epsilon",textColor:"neutral600",as:"p",children:r}):r]})})},67109:($,H,t)=>{t.d(H,{Z:()=>L});var e=t(85893);const a=R=>(0,e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1rem",height:"1rem",fill:"none",viewBox:"0 0 24 24",...R,children:(0,e.jsx)("path",{fill:"#212134",d:"M24 13.3a.2.2 0 0 1-.2.2H5.74l8.239 8.239a.2.2 0 0 1 0 .282L12.14 23.86a.2.2 0 0 1-.282 0L.14 12.14a.2.2 0 0 1 0-.282L11.86.14a.2.2 0 0 1 .282 0L13.98 1.98a.2.2 0 0 1 0 .282L5.74 10.5H23.8c.11 0 .2.09.2.2v2.6Z"})}),L=a}}]);
